!function(e){function t(n){if(i[n])return i[n].exports;var a=i[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var i={};t.m=e,t.c=i,t.i=function(e){return e},t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=171)}({136:function(e,t){new Vue({el:"#timesheet",data:{date:moment().format("YYYY-MM"),workingDay:30,totalTimesheets:0,timesheets:[],selectedTimesheet:{prj_no:"",prj_name:"",task_name:"",time_in:"",time_out:"",description:""},selectedKey:0,projects:[],holidays:[],leaveDays:[]},mounted:function(){var e=this;this.fetch(),axios.get("/project/fetchOwnProject").then(function(t){e.projects=t.data}).catch(function(e){}),$(".input-group.date").datepicker({minViewMode:1,maxViewMode:2,format:"yyyy-mm",orientation:"bottom auto",autoclose:!0}).on("changeDate",function(){e.date=$("#dateInput").val(),e.fetch()})},methods:{fetch:function(){var e=this;this.fetchHoliday(),this.fetchLeaveDays(),axios.get("/timesheet/fetch",{params:{date:this.date}}).then(function(t){e.timesheets=t.data,e.timesheets.forEach(function(t){t.isHoliday=!1,t.dayOfWeek=moment(t.date).format("ddd");for(var i=0;i<e.holidays.length;i++)if(t.date==e.holidays[i].holiday){t.isHoliday=!0,t.holidayName="("+e.holidays[i].date_name+")";break}"Sat"!=t.dayOfWeek&&"Sun"!=t.dayOfWeek||(t.isHoliday=!0)}),setTimeout(function(){e.workingDay=e.getWorkingDayInMonth(e.date)},200),e.totalTimesheets=e.getTotalTimesheets()}).catch(function(e){})},select:function(e,t){var i=Object.assign({},e);this.selectedTimesheet=i,this.selectedKey=t},remove:function(e){var t=this;bootbox.confirm({title:"Delete confirmation",message:"Do you really want to delete a task ?",buttons:{cancel:{label:"No"},confirm:{label:"Yes"}},callback:function(i){i&&axios.delete("/timesheet/destroy",{params:{date:t.timesheets[e].date,prj_no:t.timesheets[e].prj_no}}).then(function(i){Vue.delete(t.timesheets,e),t.totalTimesheets=t.getTotalTimesheets()}).catch(function(e){})}})},update:function(){var e=this;axios.post("/timesheet/update",{date:this.timesheets[this.selectedKey].date,old_prj_no:this.timesheets[this.selectedKey].prj_no,new_prj_no:this.selectedTimesheet.prj_no,new_task_name:this.selectedTimesheet.task_name,new_time_in:this.selectedTimesheet.time_in,new_time_out:this.selectedTimesheet.time_out,new_description:this.selectedTimesheet.description}).then(function(t){e.timesheets[e.selectedKey].prj_no=e.selectedTimesheet.prj_no,e.timesheets[e.selectedKey].task_name=e.selectedTimesheet.task_name,e.timesheets[e.selectedKey].time_in=e.selectedTimesheet.time_in,e.timesheets[e.selectedKey].time_out=e.selectedTimesheet.time_out,e.timesheets[e.selectedKey].description=e.selectedTimesheet.description}).catch(function(e){})},getTotalTimesheets:function(){for(var e=this,t=0,i=1;i<=moment(this.date).daysInMonth();i++)!function(i){e.timesheets.findIndex(function(e){return e.date.substr(8,2)==i})>=0&&t++}(i);return t},getWorkingDayInMonth:function(e){startDate=moment(e).format("YYYY-MM-01"),endDate=moment(e).format("YYYY-MM-")+moment(e).daysInMonth(),workingDay=moment(e).daysInMonth();for(var t=moment(startDate);t.diff(endDate,"days")<=0;t.add(1,"days"))for(var i=0;i<this.holidays.length;i++)if(moment(t).format("YYYY-MM-DD")==this.holidays[i].holiday||6==t.isoWeekday()||7==t.isoWeekday()){workingDay--;break}return workingDay-=this.leaveDays.length,workingDay},fetchHoliday:function(){var e=this;axios.get("/holiday/fetch",{params:{year:moment(this.date).format("YYYY"),month:moment(this.date).format("MM")}}).then(function(t){e.holidays=t.data}).catch(function(e){})},fetchLeaveDays:function(){var e=this;axios.get("/leave_request/get-leaves-in-month",{params:{year:moment(this.date).format("YYYY"),month:moment(this.date).format("MM")}}).then(function(t){e.leaveDays=t.data}).catch(function(e){})}}})},171:function(e,t,i){e.exports=i(136)}});